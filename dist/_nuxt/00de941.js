(window.webpackJsonp=window.webpackJsonp||[]).push([[20,5,6,16],{392:function(e,t,n){"use strict";var r,o=n(0);r=function(e){return e},t.a=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=n.deep,l=n.save,d=void 0===l?r:l,h=n.load,f=void 0===h?r:h;return{data:function(){return Object(o.a)({},e,null)},watch:(t={},Object(o.a)(t,e,{deep:c,handler:function(e){return this.$emit("input",d.call(this,e))}}),Object(o.a)(t,"value",{deep:c,immediate:!0,handler:function(t){return this[e]=f.call(this,t)}}),t)}}},393:function(e,t,n){"use strict";var r,o,c=n(33);r=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.args,r=t.callback,o=t.logOrDebug,l=void 0===o?"debug":o;return(e=console)[l].apply(e,Object(c.a)(n)),"function"==typeof r&&r(),n[n.length-1]},o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r({args:t})},o.breakpoint=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r({args:t,callback:function(){}})},o.always=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r({args:t,logOrDebug:"log"})},t.a=o},396:function(e,t,n){"use strict";var r=n(0),o=n(40),c=(n(1),n(51),n(15),n(3),n(5),n(4),n(2),n(6),n(7),n(416)),l=n(393),d=n(402),h=n.n(d);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a=function(){var e,t,n,d,f,v,y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},x=y.prefix,k=y.keys,w=y.format,O=void 0===w?"json":w;return"yaml"===O?(f=c.a.load,t=c.a.dump):(f=JSON.parse,t=JSON.stringify),d=!1,v=null,n=function(e){return x?"".concat(x,".").concat(e):e},e=function(e,t){return"object"===Object(o.a)(t)&&null!==t?f(e||null):"number"==typeof t?parseFloat(e||null):"boolean"==typeof t?"boolean"==typeof e?e:"true"===e:e||null},{data:function(){return{localLoaded:new Promise((function(e){return v=e})),watchersToIgnore:[]}},mounted:function(){var t=this;return k.forEach((function(r){var o,c;return c=localStorage.getItem(n(r)),o=t[r],console.log({key:r,localValue:c,defaultValue:o}),c=e(c,o),t[r]=h.a.isObject(o)&&!h.a.isArray(o)?m(m({},o),c):c||o,t.$nextTick((function(){return d=!0,v()}))}))},watch:m({},k.reduce((function(e,c){return Object.assign(e,Object(r.a)({},c,{deep:!0,handler:function(e){var r;return d?(r=n(c),localStorage.setItem(r,"object"===Object(o.a)(e)?t(e):e),Object(l.a)("Saved ".concat(c," to local storage as ").concat(r)),this.watchersToIgnore=h.a.without(this.watchersToIgnore,c)):this.watchersToIgnore.push(c)}}))}),{}))}}},397:function(e,t,n){"use strict";var r=n(417),o=n.n(r);t.a={data:function(){return o.a.init("f9ed5012981005142ed33251c919eb41",{debug:!0}),{mixpanel:o.a}}}},398:function(e,t,n){"use strict";n.r(t);var r,o=n(40),c=(n(247),n(15),n(19),n(1),n(37),n(4),n(62),n(11),n(30),n(22),n(392));r=function(e){return"number"===this.inputProps.type?Number(e):e};var l={mixins:[Object(c.a)("setting",{save:r,load:r})],props:{value:{required:!0},properties:{type:Object,default:function(){return{}}}},computed:{id:function(){return"edit-settings-input-".concat(this.$vnode.key,"-").concat(Math.random().toString(36).slice(2))},label:function(){return this.properties.label||this.$vnode.key},description:function(){var e;return e=this.properties.description,(null!=e?e[!0]:void 0)&&e[!1]?e[this.setting]:e},inputTagAndProps:function(){var e,t,n=this;if(t={multiline:function(){var e;return{tag:"b-textarea",props:{rows:Math.max(10,Math.min(20,null!=(e=n.value)?e.split("\n").length:void 0)),style:n.properties.monospace?"font-family: monospace; tab-size: 2; -moz-tab-size: 2;":"",placeholder:n.properties.placeholder||"Enter text here"}}},text:{tag:"b-input",props:{type:"text",placeholder:this.properties.placeholder||"Enter text here"}},number:{tag:"b-input",props:{type:"number",placeholder:this.properties.placeholder||"Enter a number here"}},boolean:{tag:"b-checkbox",props:{switch:!0}}},this.properties.type)return("function"==typeof(e=t[this.properties.type])?e():void 0)||e;switch(Object(o.a)(this.value)){case"number":return t.number;case"boolean":return t.boolean;default:return t.text}},inputTag:function(){return this.inputTagAndProps.tag},inputProps:function(){return this.inputTagAndProps.props}},methods:{onTab:function(e){var t,n,r,o,c,l,d=this;if(this.properties.monospace){var h=this.$refs.input.$el;return o=h.selectionStart,r=h.selectionEnd,l=this.value.substring(0,o),n=this.value.substring(o,r),c=this.value.substring(r),t=l.lastIndexOf("\n")||0,n=l.substring(t+1,o)+n,l=l.substring(0,t+1),n=n.replace(/(\n|^)(\t?)/g,e.shiftKey?"$1":"$1$2\t"),this.setting=l+n+c,e.preventDefault(),this.$nextTick((function(){return d.$refs.input.$el.setSelectionRange(o+(e.shiftKey?-1:1),r+(e.shiftKey?-1:1))}))}}}},d=n(68),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-form-group",e._b({attrs:{"label-for":e.id}},"b-form-group",{label:e.label,description:e.description},!1),[n(e.inputTag,e._b({ref:"input",tag:"component",attrs:{id:e.id},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.onTab.apply(null,arguments)}},model:{value:e.setting,callback:function(t){e.setting=t},expression:"setting"}},"component",e.inputProps,!1))],1)}),[],!1,null,null,null);t.default=component.exports},399:function(e,t,n){"use strict";t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768;return{data:function(){return{narrow:!1,wide:!0,width:null}},mounted:function(){var t,n=this;return(t=function(){return n.width=window.innerWidth,n.narrow=n.width<e,n.wide=!n.narrow,console.log("Width changed to ".concat(n.width))})(),window.addEventListener("resize",t)}}}},403:function(e,t,n){var content=n(420);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(109).default)("5e796bfe",content,!0,{sourceMap:!1})},404:function(e,t,n){var content=n(422);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(109).default)("d344a20e",content,!0,{sourceMap:!1})},405:function(e,t,n){"use strict";n.r(t);var r=n(392),o={mixins:[Object(r.a)("settings",{deep:!0})],props:{title:{type:String,default:"Edit settings"},okTitle:{type:String,default:"Save"},cancelTitle:{type:String,default:"Cancel"},value:{type:Object,required:!0},properties:{type:Object,default:function(){return{}}}}},c=n(68),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-form",{staticStyle:{width:"100%"}},e._l(e.settings,(function(t,r){return n("EditSettingsInput",{key:r,attrs:{properties:e.properties[r]},model:{value:e.settings[r],callback:function(t){e.$set(e.settings,r,t)},expression:"settings[key]"}})})),1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{EditSettingsInput:n(398).default})},407:function(e,t,n){"use strict";var r,o=n(0),c=n(34);n(84),n(1),n(15),n(5),n(4),n(2),n(6),n(3),n(7);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a={data:function(){return{actionPromises:{}}},methods:{actionPromise:function(e){var t;return null!=(t=this.actionPromises[e])?t:Promise.resolve()},try:(r=Object(c.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,l,track,h,f,m,v,y,x,k=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=k.length>2&&void 0!==k[2]?k[2]:{},o=r.errorMessage,c=r.except,l=r.track,track=void 0===l||l,h=r.mixpanelProps,track&&(m=this.mixpanel),this[t]=!0,y=null,v=null,this.actionPromises[t]=new Promise((function(e,t){return y=e,v=t})),e.prev=6,console.log("Started ".concat(t)),null!=m&&m.track("".concat(t," started"),h),e.t0=y,e.next=12,n();case 12:return e.t1=x=e.sent,(0,e.t0)(e.t1),null!=m&&m.track("".concat(t," succeeded"),h),e.abrupt("return",x);case 18:return e.prev=18,e.t2=e.catch(6),f=e.t2,console.error("Error while ".concat(t,": ").concat(f)),null!=m&&m.track("".concat(t," failed"),d({error:f.message},h)),"function"==typeof o&&(o=o(f)),this.alert(o),"function"==typeof c&&c(f),e.abrupt("return",v(f));case 27:return e.prev=27,this[t]=!1,console.log("Finished ".concat(t)),e.finish(27);case 31:case"end":return e.stop()}}),e,this,[[6,18,27,31]])}))),function(e,t){return r.apply(this,arguments)}),alert:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Something went wrong.";return this.$bvToast.toast("See console for error details.",{title:e,variant:"danger",solid:!0,autoHideDelay:5e3})}}}},408:function(e,t,n){"use strict";(function(e){n(5),n(4),n(2),n(1),n(6),n(3),n(7);var r=n(0),o=n(86),c=n.n(o),l=n(393);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a=function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.polygonAPIurl,o=void 0===r?"https://ideality.app/api/polygon/":r,d=n.templatesDatabaseId,f=void 0===d?"485b3bd6b4524c1dbd9ef2acc5bccfbf":d,m=n.upvotesDatabaseId,v=void 0===m?"ecdca719f95b4eeab4c86118e44d162c":m,y=n.openAIkey,x=void 0===y?e.env.OPENAI_KEY:y,k=n.defaultParameters,w=void 0===k?{}:k,O=n.spent,C=n.vm,j=n.vmKey;return t=c.a.create({baseURL:o}),console.log("Polygon client initialized",{polygonAPIurl:o,templatesDatabaseId:f,upvotesDatabaseId:v,openAIkey:x,defaultParameters:w}),{spent:O,run:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return console.log("Running",e,{variables:r,parameters:o}),t.post("/run",{databaseId:f,slug:e,openAIkey:x,variables:r,parameters:h(h({},w),o)}).then((function(e){var data=e.data;return Object(l.a)("USD spent",n.spent+=data.approximateCost),C&&(C[j]=n.spent),data}))},upvote:function(e){return console.log("Upvoting",e),t.post("/upvote",{databaseId:v,generationId:e}).then((function(e){return e.data}))}}}}).call(this,n(133))},419:function(e,t,n){"use strict";n(403)},420:function(e,t,n){var r=n(108)(!1);r.push([e.i,'#eyes[data-v-7fddc919]{font-size:32px;font-family:monospace;white-space:pre}#monologue[data-v-7fddc919]{font-size:20px;font-family:"Playfair Display","Georgia","Times New Roman","Times",serif}',""]),e.exports=r},421:function(e,t,n){"use strict";n(404)},422:function(e,t,n){var r=n(108)(!1);r.push([e.i,".code[data-v-0a55d814]{font-family:monospace;background-color:#1e1e1e;color:#d4d4d4;height:calc(100% - 2.5em)}",""]),e.exports=r},427:function(e,t,n){var content=n(460);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(109).default)("1b7833da",content,!0,{sourceMap:!1})},429:function(e,t,n){"use strict";n.r(t);n(171);var r,o,c=n(34),l=n(29),d=n(28),h=n(67),f=n(126),m=n(49),v=n(166),y=(n(84),n(406),n(11),n(22),n(1),n(3),n(18),n(16),n(63),n(50),n(30),n(393)),x={data:function(){var e;return e={state:!1},Object.assign(e,{promise:new Promise((function(t){return Object.assign(e,{resolve:t})}))}),{mounted:e}},mounted:function(){return this.mounted.resolve(),this.mounted.state=!0}},k=n(397);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(m.a)(e);if(t){var o=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}r=function(e){Object(h.a)(n,e);var t=w(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n)}(Object(v.a)(Error)),o=function(line){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(line.length-line.trimLeft().length)/e};var O,C={mixins:[x,k.a],props:["value","readonly"],data:function(){return{chartRendered:!1,editInPlainText:!1,wasInvalid:!1,contextChanged:!1}},computed:{context:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isValid:function(){var e;try{return this.validate(this.context),this.wasInvalid&&(this.wasInvalid=!1,this.mixpanel.track("Context fixed")),!0}catch(t){return e=t,console.error(e),this.wasInvalid||(this.wasInvalid=!0,this.mixpanel.track("Invalid context")),!1}},mermaidString:function(){var e;try{this.validate(this.context)}catch(e){return e,""}return e="mindmap\n"+this.context.replace(/[~@\-~"()]/g,(function(e){return"#".concat(e.charCodeAt(0),";")})),console.log(e),e}},mounted:function(){var script;return console.log("MindyContext mounted"),document.getElementById("mermaid-init")?console.log("mermaid-init script already exists"):(console.log("creating mermaid-init script"),(script=document.createElement("script")).id="mermaid-init",script.type="module",window.mermaidLoaded={state:!1,resolve:null},window.mermaidLoaded.promise=new Promise((function(e){return Object.assign(window.mermaidLoaded,{resolve:e})})),script.innerHTML="let resolve = null\nimport mermaid from 'https://unpkg.com/mermaid@9/dist/mermaid.esm.mjs';\nconsole.log({mermaid})\nimport mindmap from 'https://unpkg.com/@mermaid-js/mermaid-mindmap@9/dist/mermaid-mindmap.esm.mjs';\nconsole.log({mindmap})\nawait mermaid.registerExternalDiagrams([mindmap]);\nmermaid.startOnLoad = false;\nObject.assign(window, {mermaid, mindmap});\nconsole.log('mermaid loaded')\nwindow.mermaidLoaded.state = true\nwindow.mermaidLoaded.resolve()",document.head.appendChild(script),console.log(script))},watch:{mermaidString:{immediate:!0,handler:(O=Object(c.a)(regeneratorRuntime.mark((function e(t){var element,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.chartRendered=!1,console.log("Creating mermaid chart for",t),this.mounted.state){e.next=7;break}return console.log("Waiting for the component to be mounted"),e.next=6,this.mounted.promise;case 6:console.log("Component mounted");case 7:if(window.mermaidLoaded.state){e.next=12;break}return console.log("Waiting for mermaid to be loaded"),e.next=11,window.mermaidLoaded.promise;case 11:console.log("Mermaid loaded");case 12:return element=document.getElementById("mermaid-container"),e.abrupt("return",this.$nextTick((function(){return console.log("Updating mermaid chart"),mermaid.renderAsync("mermaid-".concat(Date.now()),t,(function(svg){return element.innerHTML=svg,n.chartRendered=!0,console.log("Mermaid chart updated"),element.querySelectorAll("text").forEach((function(element){return element.style.cursor="pointer",element.addEventListener("click",(function(){var text;return text=(text=Array.from(element.querySelectorAll("tspan")).map((function(element){return element.textContent})).join(" ")).replace(/\s+/g," "),n.$emit("node-clicked",Object(y.a)(text))}))}))}))})));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},context:function(){if(!this.contextChanged)return this.contextChanged=!0,this.mixpanel.track("Context changed")}},methods:{helloWorld:function(){return console.log("Hello world")},validate:function(e){var i,t,n,c,l;if(!e)throw new r("Context is empty");if(n=e.split("\n"),0!==o(n[0]))throw new r("The first line must not be indented");if(0===o(n[1]))throw new r("The second line must be indented");for(l=o(n[1],1),i=t=2,c=n.length;2<=c?t<c:t>c;i=2<=c?++t:--t){if(o(n[i],l)>o(n[i-1],l)+1)throw new r("Line ".concat(i+1," is indented by more than one level more than the previous line"));if(o(n[i],l)<1)throw new r("Line ".concat(i+1," is not indented; only one root topic is allowed"))}return!0}}},j=C,I=(n(421),n(68)),component=Object(I.a)(j,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-col",[n("b-row",{staticClass:"justify-content-center",attrs:{id:"mermaid-container"}}),e.readonly?e._e():[e.isValid?e._e():n("b-alert",{staticClass:"text-left mt-3",attrs:{variant:"danger",show:""}},[n("strong",[e._v("Cannot render the mind map; please edit the context below:")]),n("ul",[n("li",[e._v("Exactly one line with no tabs in the beginning")]),n("li",[e._v("Every next line indented by the same, fewer, or just one more tab than the previous line")])])]),n("b-button",{staticClass:"btn-sm btn-light m-1",attrs:{variant:e.isValid?e.editInPlainText?"outline-success":"light":"outline-danger"},on:{click:function(t){e.editInPlainText=!e.editInPlainText,e.mixpanel.track("Switched plain text context editing "+(e.editInPlainText?"on":"off"))}}},[e._v("üñâ")]),n("b-button",{staticClass:"btn-sm btn-light m-1",on:{click:function(t){return e.$emit("rebuild")}}},[e._v("‚Ü∫")]),n("b-row",{directives:[{name:"show",rawName:"v-show",value:e.editInPlainText||!e.isValid,expression:"editInPlainText || !isValid"}],style:e.isValid?"":"border: 1px solid red; border-radius: 5px; padding: 10px;"},[n("EditSettings",{attrs:{title:"Edit context in plain text",value:{context:e.context},properties:{context:{type:"multiline",monospace:!0,label:"Mind map tree",placeholder:"Main topic\n\tSub-topic\n\t\tSub-sub-topic\n\tAnother sub-topic",description:"Tab/Shift-Tab to indent/unindent lines."}}},on:{input:function(t){e.context=t.context}}})],1)]],2)}),[],!1,null,"0a55d814",null);t.default=component.exports;installComponents(component,{EditSettings:n(405).default})},431:function(e,t,n){"use strict";n.r(t);var r,o=n(33),c=n(35),l=n(34),d=(n(84),n(41),n(418),n(16),n(11),n(30),n(22),n(38),n(19),n(15),n(18),n(1),n(408)),h=n(393),f=n(396),m={mixins:[Object(f.a)({keys:["darkmodeEverUsed"],prefix:"mindy"})],props:{polygon:{type:d.a,required:!0},context:{default:"stuff"}},data:function(){return{lines:[],blinkTimeout:null,getLineTimeout:null,darkmodeEverUsed:!1}},mounted:function(){return setTimeout(this.getLine,2e3*Math.random()+1e3),setTimeout(this.blink,2e3*Math.random()+1e3)},computed:{topics:function(){return this.context.split("\n").map((function(line){return line.trim().replace(/^[-*+]\s*/,"").toLowerCase()}))}},methods:{randomTopic:function(){var e;return Object(h.a)("Using topic",this.topics.length>1?(e=this.topics.slice(1),"".concat(this.topics[0]," and ").concat(e[Math.floor(Math.random()*e.length)])):this.topics[0])},getLine:(r=Object(l.a)(regeneratorRuntime.mark((function e(){var t,line,n,r,l,text,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(r=this.$refs)?r.container:void 0){e.next=2;break}return e.abrupt("return");case 2:return t=!!this.lines.length,l=t?"darkmode-continued":"darkmode",this.darkmodeEverUsed&&(l+="-repeated"),n=this.lines.join("‚Äù\nThen: ‚Äú"),e.next=8,this.polygon.run(l,{topic:this.randomTopic(),previousLines:n},{max_tokens:50,temperature:.7,n:1,stop:["‚Äù",'"']});case 8:return d=e.sent,h=Object(c.a)(d.choices,1),text=h[0].text,d.approximateCost,this.darkmodeEverUsed=!0,(line=text.replace(/[‚Äù"\n].*/,"").trim())&&(this.lines=[].concat(Object(o.a)(this.lines),[line])),e.abrupt("return",this.getLineTimeout=setTimeout(this.getLine,2e3+4e3*Math.random()));case 16:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)}),blink:function(){var e;if(null!=(e=this.$refs)?e.container:void 0)return document.getElementById("eyes").innerText=["( üëÅÔ∏è )  ( üëÅÔ∏è )","(    )   (    )","(  üëÅÔ∏è)  (  üëÅÔ∏è)","(üëÅÔ∏è  )  (üëÅÔ∏è  )"][Math.floor(4*Math.random())],this.blinkTimeout=setTimeout(this.blink,1e3*Math.random()+1e3)},turnOnTheLights:function(){var e,t;return t=null,e=new Promise((function(e){return t=e})),this.$emit("wheres-the-fucking-light-switch",e),this.lines.length?this.polygon.run("darkmode-ended",{topic:"stuff",previousLines:this.lines.join("‚Äù\nThen: ‚Äú")},{max_tokens:50,temperature:.7,n:1,stop:["‚Äù",'"']}).then((function(e){var text=Object(c.a)(e.choices,1)[0].text;return t(text)})):t()}},beforeDestroy:function(){return clearTimeout(this.blinkTimeout),clearTimeout(this.getLineTimeout)}},v=m,y=(n(419),n(68)),component=Object(y.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{ref:"container",staticClass:"justify-content-center align-items-center text-center d-flex flex-column",staticStyle:{height:"100vh","background-color":"black",color:"white"},attrs:{fluid:""},on:{dblclick:e.turnOnTheLights}},[n("b-row",[n("b-col",[n("p",{attrs:{id:"eyes"}},[e._v("( üëÅÔ∏è )  ( üëÅÔ∏è )")]),n("div",{staticClass:"mt-5"},e._l(e.lines,(function(line,t){return n("p",{key:t,attrs:{id:"monologue"},domProps:{textContent:e._s(line)}})})),0)])],1)],1)}),[],!1,null,"7fddc919",null);t.default=component.exports},432:function(e,t,n){"use strict";n.r(t);var r=n(34),o=(n(84),n(86)),c=n.n(o),l=n(407),d=n(397),h=n(396),f={mixins:[l.a,d.a,Object(h.a)({keys:["acknowledged"],prefix:"mindy"})],props:["value"],data:function(){return console.log("OpenAIKeyModal value: ".concat(this.value)),{openAIkey:this.value,checkingKey:!1,keyValid:!!this.value,acknowledged:!1}},computed:{canClose:function(){return this.openAIkey&&this.keyValid&&this.acknowledged}},methods:{show:function(){return this.$refs.openAIKeyModal.show()},hide:function(){return this.$refs.openAIKeyModal.hide()},checkKey:function(){var e=this;return this.try("checkingKey",Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Checking key ".concat(e.openAIkey)),t.next=3,c.a.post("https://api.openai.com/v1/engines/text-ada-001/completions",{prompt:"Hello",max_tokens:1},{headers:{Authorization:"Bearer ".concat(e.openAIkey)}});case 3:return e.$bvToast.toast("Yay, the key is valid! Enjoy the app!",{title:"Success",variant:"success",autoHideDelay:3e3}),e.keyValid=!0,e.$emit("input",e.openAIkey),t.abrupt("return",e.mixpanel.track("OpenAI key validated"));case 7:case"end":return t.stop()}}),t)}))),{errorMessage:function(e){var t;return 401===(null!=e&&null!=(t=e.response)?t.status:void 0)&&"Invalid API key"},except:function(){return e.mixpanel.track("Error checking OpenAI key")}})}}},m=n(68),component=Object(m.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"openAIKeyModal",attrs:{title:"Enter your OpenAI API key","hide-footer":!e.canClose,"no-close-on-backdrop":!e.canClose,"no-close-on-esc":!e.canClose,"hide-header-close":!e.canClose,"ok-only":""}},[n("h4",[e._v("Why?")]),n("p",[e._v("This app uses the OpenAI API to generate texts.\nWe "),n("a",{attrs:{href:"https://github.com/vzakharov/ideality-nuxt/blob/master/api/polygon/index.coffee",target:"_blank"}},[e._v("do not store")]),e._v("\nyour API key anywhere on our servers.")]),n("p",[e._v("You can get your OpenAI key¬†"),n("a",{attrs:{href:"https://beta.openai.com/account/api-keys",target:"_blank"}},[e._v("here")]),e._v(".")]),n("b-form",{on:{submit:function(t){return t.preventDefault(),e.checkKey()}}},[n("b-form-group",{attrs:{label:"OpenAI API key","label-for":"openAIkey"}},[n("b-form-input",{attrs:{id:"openAIkey",type:"text",placeholder:"sk-...",disabled:e.checkingKey},model:{value:e.openAIkey,callback:function(t){e.openAIkey=t},expression:"openAIkey"}})],1),n("b-button",{attrs:{type:"submit",variant:e.keyValid?"outline-secondary":"primary",disabled:!e.openAIkey||e.checkingKey}},[n("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.checkingKey,expression:"checkingKey"}],attrs:{small:"",type:"grow"}}),e._v(e._s(e.checkingKey?"Checking...":"Check and save"))],1)],1),n("b-checkbox",{staticClass:"mt-4",staticStyle:{"font-size":"1.2em"},model:{value:e.acknowledged,callback:function(t){e.acknowledged=t},expression:"acknowledged"}},[e._v("I understand that I will be spending my own OpenAI tokens (credits) to generate texts.")])],1)}),[],!1,null,null,null);t.default=component.exports},459:function(e,t,n){"use strict";n(427)},460:function(e,t,n){var r=n(108)(!1);r.push([e.i,"body{font-size:.75em}.message-content :last-child{margin-bottom:0}label{font-weight:700}.footer{border-top:1px solid #e7e7e7}.footer,.header{background-color:#f7f7f7}.header{border-bottom:1px solid #e7e7e7}",""]),e.exports=r},463:function(e,t,n){"use strict";n.r(t);n(5),n(4),n(6),n(7);var r,o=n(0),c=n(35),l=n(34),d=n(33),h=(n(84),n(24),n(18),n(15),n(16),n(85),n(110),n(2),n(1),n(11),n(30),n(173),n(22),n(134),n(3),n(406),n(38),n(249),n(41),n(86),n(402)),f=n.n(h),m=(n(437),n(174),n(393));r=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.childOrder,o=void 0===r?[["createdAt","desc"]]:r,c=n.vm;return Object.assign(this,{items:e,root:{id:0},find:function(e){return f.a.find(this.items,{id:e})},getters:{parent:function(t){return e.find((function(i){return i.id===t.parentId}))||this.root},children:function(t){return f()(e).filter((function(e){return t?e.parentId===t.id:!e.parentId})).orderBy(o).value()},siblings:function(t){var n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return f.a.orderBy(e.filter((function(e){return n.parent(e)===n.parent(t)&&(r||e!==t)}),o))},numSiblings:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.siblings(e,t).length},siblingIndex:function(e){return this.siblings(e).indexOf(e)},sibling:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(t=((t=this.siblingIndex(e))+n)%this.numSiblings(e);t<0;)t+=this.numSiblings(e);return this.siblings(e)[t]},nextSibling:function(e){return this.sibling(e,1)},prevSibling:function(e){return this.sibling(e,-1)},ancestors:function(e){return(null!=e?e.parentId:void 0)?[this.parent(e)].concat(Object(d.a)(this.ancestors(this.parent(e)))):[]},lineage:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.includeSelf,o=void 0===r||r;return Object(m.a)("Calculating lineage for ".concat(null!=e?e.id:void 0,", includeSelf: ").concat(o)),t=Object(d.a)(this.ancestors(e)).reverse(),o&&e&&t.push(e),(null!=t?t[0]:void 0)===this.root&&t.shift(),Object(m.a)("lineage",t)},heir:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.nested;return Object(m.a)("Calculating heir for ".concat(null!=e?e.id:void 0)),Object(m.a)("children",t=this.children(e)),t.length?(Object(m.a)("heir",n=t[e.heirIndex||0]),o?this.heir(n,{nested:!0}):void 0):e},thread:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(m.a)("thread",this.lineage(t?this.heir(e,{nested:!0}):e))},heritage:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.includeSelf,c=void 0===o||o;return Object(m.a)("Calculating heritage for ".concat(null!=e?e.id:void 0)),Object(m.a)("thread",n=this.thread(e)),Object(m.a)("lineage",t=this.lineage(e,{includeSelf:!c})),Object(m.a)("heritage",f.a.difference(n,t))}},cache:{},createChild:function(t,n){return Object(m.a)({item:t},Object.assign(n,{parentId:null!=t?t.id:void 0,id:f()(e).map("id").max()+1||1,createdAt:new Date}))},clone:function(e){return this.createChild(this.parent(e),f.a.omit(e,"id","createdAt"))},delete:function(t){var n,r=this;return n=this.children(t),e.splice(e.indexOf(t),1),n.forEach((function(e){return r.delete(e)})),e},nudge:function(e){var t,n;if(n=this.parent(e))return Object(m.a)("Nudging item ".concat(e.id," to be the heir of its parent ").concat(n.id)),t=this.siblingIndex(e),c?c.$set(n,"heirIndex",t):f.a.assign(n,{heirIndex:t})}}),f.a.forEach(this.getters,(function(e,n){return t[n]=function(t){for(var path,r,o=arguments.length,c=new Array(o>1?o-1:0),l=1;l<o;l++)c[l-1]=arguments[l];return path=[null!=(r=null!=t?t.id:void 0)?r:"undefined",n,JSON.stringify(c)],f.a.has(this.cache,path)||f.a.set(this.cache,path,e.apply(this,[t].concat(c))),f.a.get(this.cache,path)}})),this};var v,y=r,x=n(396),k={mounted:function(){var e;if(window.vm){for(e=1;window["vm".concat(e)];)e++;return window["vm".concat(e)]=this}return window.vm=this}},w=n(407),O={data:function(){return{window:null}},mounted:function(){return Object.assign(this,{window:window})}},C=n(397),j=n(399),I=n(408);function _(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function M(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}v={allowFineTuning:!0,autoBuildContext:!0,numGenerations:3,temperature:.6};var S,A,T,P={mixins:[Object(x.a)({keys:["user","messages","openAIkey","usdSpent","settings","chatboxCollapsed","chatboxHorizontalAnchor","fineTuningRequested"],format:"yaml",prefix:"mindy"}),k,w.a,O,C.a,Object(j.a)()],head:function(){var e,content,t=this.routedMessage||{};return e=t.bookmark,content=t.content,{title:this.routedMessage?"".concat((null!=e?e.name:void 0)?"".concat(e.name," (bookmark)"):content," ¬∑ Mindy"):"Mindy ¬∑ Brainstorm with AI",meta:[{name:"viewport",content:"width=device-width, initial-scale=1, user-scalable=no"}]}},data:function(){return{suggestions:[],hoveredMessage:null,fineTuningRequested:!1,chatboxCollapsed:!1,chatboxVerticalAnchor:"top",chatboxHorizontalAnchor:"left",darkmode:!1,settings:v,input:"",lastMessageTime:null,sending:!1,generatingContext:!1,generatingReply:!1,enteredName:"",checkingName:!1,editing:{message:null,input:""},nameUnavailable:!1,user:{name:"you"},messages:[],openAIkey:null,routedMessage:null,typingCount:0,typingInterval:null,usdSpent:0,bot:{name:"mindy",isBot:!0},idsBySlug:null,previousThread:null}},computed:{generating:function(){return this.generatingContext||this.generatingReply},suggestionsContext:function(){if(this.suggestions.length)return Object(m.a)("Suggestion context",this.suggestionsContext=["Hey Mindy!"].concat(Object(d.a)(this.suggestions.map((function(e){return"\t".concat(e)})))).join("\n"))},messageForContext:function(){var e;return this.routedMessage&&Object(m.a)("Message with context for routed message ".concat(this.routedMessage.id),e=this.getMessageWithContext(this.routedMessage)),!e&&this.suggestionsContext&&Object(m.a)("Using suggestions context",e={id:0,context:this.suggestionsContext}),e},context:function(){var e;return null!=(e=this.routedMessage)?e.context:void 0},tree:function(){return new y(this.messages,{vm:this})},thread:function(){var e;return this.routedMessage?(null!=(e=this.previousThread)?e.includes(this.routedMessage):void 0)?this.previousThread:this.previousThread=this.tree.thread(this.routedMessage||this.tree.root):[]},lastMessage:function(){return f.a.last(this.thread)},polygon:function(){return new I.a({openAIkey:this.openAIkey,vm:this,vmKey:"usdSpent",spent:this.usdSpent,defaultParameters:{max_tokens:300,n:this.settings.numGenerations,temperature:this.settings.temperature}})}},mounted:function(){var e;return this.mixpanel.track("Started"),this.openAIkey?null!=(e=this.$refs.input)?e.focus():void 0:(console.log("OpenAI key not set; showing modal"),this.$refs.openAIkeyModal.show())},methods:{getSuggestions:function(){var e=this;return this.try("generatingContext",Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=m.a,t.next=3,function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(){var text,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.polygon.run("suggest",{},{stop:["\n\n"],temperature:1});case 2:return r=t.sent,o=Object(c.a)(r.choices,1),text=o[0].text,t.abrupt("return",n=text.split("\n").filter((function(line){return line.match(/\?$/)})).map((function(line){return line.replace(/^\d+\.\s*/,"")})));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()();case 3:if(t.t1=n=t.sent,(0,t.t0)("Suggestions:",t.t1),e.suggestions=[].concat(Object(d.a)(e.suggestions),Object(d.a)(n)),!(e.suggestions.length<3)){t.next=8;break}return t.abrupt("return",e.$nextTick(e.getSuggestions));case 8:case"end":return t.stop()}}),t)}))))},getMessageWithContext:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.includeSelf,r=void 0===n||n,o=t.direction,c=void 0===o?"both":o;if(e)return Object(m.a)("Message with context for ".concat(e.id," (direction: ").concat(c,", includeSelf: ").concat(r,")"),function(){switch(c){case"past":return f.a.findLast(this.tree.lineage(e,{includeSelf:r}),(function(e){return e.context}));case"future":return f.a.find(this.tree.heritage(e,{includeSelf:r}),(function(e){return e.context}));case"both":return this.getMessageWithContext(e,{includeSelf:r,direction:"past"})||this.getMessageWithContext(e,{includeSelf:r,direction:"future"})}}.call(this))},bookmark:function(e){var t;if(e.bookmark){if(confirm("Delete the bookmark? THERE IS NO UNDO!"))return this.$set(e,"bookmark",!1)}else if(t=prompt("Bookmark this reply as what? (Leave blank to bookmark anonymously)"))return this.$set(e,"bookmark",!t||{name:t})},turnOffDarkmode:(T=Object(l.a)(regeneratorRuntime.mark((function e(t){var text;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.darkmode=!1,e.prev=1,e.next=4,t;case 4:return text=e.sent,e.abrupt("return",this.$bvToast.toast(text,{title:"üí°",variant:"success",autoHideDelay:50*text.length}));case 8:e.prev=8,e.t0=e.catch(1);case 10:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return T.apply(this,arguments)}),upvote:function(e){var t;return this.fineTuningRequested?(t=e.upvoted,this.$set(e,"upvoted",!t),e.upvoted?(this.mixpanel.track("Upvoted"),e.everUpvoted||this.polygon.upvote(e.generationId),this.$set(e,"everUpvoted",!0)):this.mixpanel.track("Unupvoted")):(this.$bvModal.show("fine-tuning-request-modal"),this.fineTuningRequested=!0,this.mixpanel.track("Fine-tuning requested"))},toggleChatboxCollapsed:function(){if(this.chatboxCollapsed=!this.chatboxCollapsed,!this.chatboxCollapsed)return this.chatboxVerticalAnchor="top",this.chatboxHorizontalAnchor="left"},rotateChatboxAnchor:function(){return"top"===this.chatboxVerticalAnchor?"left"===this.chatboxHorizontalAnchor?this.chatboxHorizontalAnchor="right":this.chatboxVerticalAnchor="bottom":"right"===this.chatboxHorizontalAnchor?this.chatboxHorizontalAnchor="left":this.chatboxVerticalAnchor="top"},addMessage:function(e){return this.messages=[].concat(Object(d.a)(this.messages),[e]),e},edit:function(e){return this.editing.message=e,this.editing.input=e.content},sendMessage:function(){var e,t,n,r=this,input=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.a.last(this.thread)||this.tree.root,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return console.log({input:input,parent:o,retrying:c}),(c?this.tree.parent(o):o)!==this.tree.root&&(e=!0,t=this.tree.lineage(o,!c).map((function(e){var t=e.user.isBot,content=e.content;return"".concat(t?"Mindy":"User",":\n").concat(content)})).join("\n\n"),console.log({previousConversation:t})),n=e?"continued":"first",this.try("sending",(function(){var e;return c?e=o:(e=r.addMessage(r.tree.createChild(o,{user:r.user,content:input})),r.input="",r.routedMessage=e,r.$nextTick((function(){var e;return null!=(e=r.$refs.scrollToBottom)?e.scrollIntoView():void 0}))),console.log({message:e}),r.$nextTick((function(){return r.try("generatingReply",Object(l.a)(regeneratorRuntime.mark((function o(){var c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.polygon.run(n,{input:input,previousConversation:t},{stop:"User:",n:r.settings.temperature>0?r.settings.numGenerations:1});case 2:return l=o.sent,c=l.choices,l.generationId,r.input="",console.log({message:e,choices:c}),c.forEach((function(t){var n,text=t.text,o=t.generationId;if(n=r.addMessage(r.tree.createChild(e,{user:r.bot,content:text,generationId:o})),console.log({reply:n}),r.settings.autoBuildContext)return r.mixpanel.track("Auto context triggered"),r.$nextTick((function(){return r.generateContext(n)}))})),o.abrupt("return",r.$nextTick((function(){var e;return r.routedMessage=f.a.last(r.messages),null!=(e=r.$refs.scrollToBottom)&&e.scrollIntoView(),r.focusOnInput()})));case 9:case"end":return o.stop()}}),o)}))),{mixpanelProps:{retrying:c,settings:r.settings,lineageLength:r.tree.lineage(o).length},except:function(t){return console.error(t),r.messages=f.a.without(r.messages,e),input=e.content}})}))}),{track:!1})},focusOnInput:function(){return this.$nextTick((function(){var e;return(e=new MutationObserver((function(t){var n,r;if(n=t.find((function(e){var t=e.attributeName,n=e.target.disabled;return"disabled"===t&&!n})))return null!=(r=n.target)&&r.focus(),e.disconnect()}))).observe(document.querySelector("#input"),{attributes:!0})}))},getConversation:function(e){return f.a.isArray(e)||(e=this.tree.lineage(e,{includeSelf:!0})),e.map((function(e){var t=e.user.isBot,content=e.content;return"".concat(t?"Mindy":"User",":\n").concat(content)})).join("\n\n")},generateContext:function(e){var t=this;return this.try("generatingContext",Object(l.a)(regeneratorRuntime.mark((function n(){var r,o,l,d,h,f,v,y,x,text,k,w;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Object(m.a)("Generating context for",e),y=t.getMessageWithContext(e,{includeSelf:!1,direction:"past"}),x=(r=!!y)?"context-rebuild":"context",Object(m.a)({slug:x}),Object(m.a)("Conversation before ".concat(r?"previous context":"current message"),l=t.getConversation(y||e)),r&&(v=y.context,Object(m.a)("Messages after previous context",h=t.tree.heritage(y,{includeSelf:!1})),Object(m.a)("Conversation after previous context",o=t.getConversation(h))),n.next=9,t.polygon.run(x,{conversationBeforePreviousContext:l,previousContext:v,conversationAfterPreviousContext:o},{stop:"```",temperature:.5,n:1});case 9:return k=n.sent,w=Object(c.a)(k.choices,1),text=w[0].text,d=function(line){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(line.length-line.trimLeft().length)/e},f=function(e){var t,n;return t=(e=(e="function"==typeof e.replace?e.replace(/```[\s\S]*?/,""):void 0).trim()).trim().split("\n"),n=d(t[1],1),(t=t.map((function(line){var e;return e=d(line,n),line.replace(/^\s*/,"\t".repeat(e)).replace(/(^\s*)[-*‚Ä¢]\s*/,"$1")}))).join("\n")},n.abrupt("return",t.$set(e,"context",Object(m.a)("Post-processed context",f(text))));case 15:case"end":return n.stop()}}),n)}))),{except:function(e){return console.error(e)}})},cloneAndSend:function(){try{return this.sendMessage(this.editing.input,this.tree.parent(this.editing.message))}finally{this.editing.message=null}}},watch:M(M({},f.a.transform(v,(function(e,t,n){return e["settings.".concat(n)]=function(e){var t;if(!(null!=(t=this.watchersToIgnore)?t.includes("settings"):void 0))return this.mixpanel.track({allowFineTuning:e?"Fine tuning enabled":"Fine tuning disabled",autoBuildContext:e?"Auto context enabled":"Auto context disabled",temperature:"Temperature changed",numGenerations:"Num generations changed"}[n],f.a.isBoolean(e)?void 0:Object(o.a)({},n,e))}}))),{},{usdSpent:function(e,t){var n;if(!(null!=(n=this.watchersToIgnore)?n.includes("usdSpent"):void 0))return console.log("USD spent",e,t),this.mixpanel.track("USD spent",{total:e,delta:e-t})},generatingReply:function(e){var t=this;return clearInterval(this.typingInterval),e?(this.$nextTick((function(){var e;return null!=(e=t.$refs.scrollToBottom)?e.scrollIntoView():void 0})),this.typingInterval=setInterval((function(){return t.typingCount=(t.typingCount+1)%3}),500)):this.typingCount=0},routedMessage:function(e){var t,n;if(e)return t=e.id,e.user.isBot,this.tree.nudge(e),t!==parseInt(null!=(n=this.$route.query)?n.id:void 0)&&(Object(m.a)("Routing to message #".concat(t)),this.$router.push({query:{id:e.id}})),this.$nextTick((function(){var e;return null!=(e=document.getElementById("message-".concat(t)))?e.scrollIntoView():void 0}))},"$route.query.id":{immediate:!0,handler:(A=Object(l.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(m.a)("Navigating to message #".concat(t)),!t){e.next=7;break}return e.next=4,this.localLoaded;case 4:"last"===t&&(r=f.a.last(this.messages),t=r.id),(n=this.tree.find(parseInt(t)))?this.routedMessage=n:Object(m.a)("Message #".concat(t," not found"));case 7:if(this.routedMessage){e.next=11;break}return e.next=10,this.localLoaded;case 10:return e.abrupt("return",this.getSuggestions());case 11:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},"$route.query.bookmark":{immediate:!0,handler:(S=Object(l.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return e.next=3,this.localLoaded;case 3:if(!(n=f.a.find(this.messages,{bookmark:{name:t}}))){e.next=8;break}return e.abrupt("return",this.routedMessage=n);case 8:return Object(m.a)("Bookmark ".concat(t," not found")),e.abrupt("return",this.routedMessage=null);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})}})},$=P,E=(n(459),n(68)),component=Object(E.a)($,(function(){var e,t=this,n=t.$createElement,r=t._self._c||n;return t.darkmode?r("DarkMode",t._b({on:{"wheres-the-fucking-light-switch":t.turnOffDarkmode}},"DarkMode",{polygon:t.polygon,context:t.context},!1)):r("div",[r("b-container",{staticClass:"px-4",attrs:{fluid:""}},[r("b-row",{staticStyle:{height:"calc(100vh - 80px)"},attrs:{"align-v":"center"}},[t.chatboxCollapsed?r("div",{staticClass:"m-1 p-2 shadow-sm rounded-lg",staticStyle:{"font-size":"1em",cursor:"pointer",position:"absolute",top:"10px",left:"10px","z-index":"1000","background-color":"rgba(0, 0, 0, 0.1)"},on:{click:t.toggleChatboxCollapsed}},[t._v("üí¨")]):r("b-col",{staticClass:"pt-4",style:t.chatboxCollapsed?(e={position:"fixed"},e[t.chatboxVerticalAnchor]="top"===t.chatboxVerticalAnchor?"10px":"60px",e[t.chatboxHorizontalAnchor]="10px",e.width="64px",e.boxShadow="0 0 10px 0 rgba(0, 0, 0, 0.5)",e.zIndex=1e3,e):{height:t.wide?"calc(100vh - 50px)":"55vh"}},[t.messages?[r("div",{staticClass:"header text-center border-top border-right border-left"},[r("div",{staticClass:"px-2 float-right text-muted",staticStyle:{cursor:"pointer",position:"absolute",top:"25px",left:"15px","z-index":"1000","font-size":"1.5em"},on:{click:t.toggleChatboxCollapsed}},[t._v("‚§£")]),t.wide?r("div",[r("h1",{staticClass:"mb-0 display-3",staticStyle:{"font-size":"3em"}},[t._v("Mindy")]),r("p",{staticClass:"lead",staticStyle:{"font-size":"1em"}},[t._v("Brainstorm with AI")])]):r("div",{staticClass:"lead",staticStyle:{"font-size":"1.5em"}},[t._v("Mindy ¬∑ Brainstorm with AI")])]),t.chatboxCollapsed?t._e():r("div",{staticClass:"border-right border-left",style:{height:t.wide?"calc(100vh - 300px)":"calc(55vh - 170px)",overflowY:"scroll"},attrs:{id:"messages"}},[t._l(t.thread,(function(e,n){return r("div",{key:n,ref:"message-"+e.id,refInFor:!0,staticClass:"message p-2",style:{"background-color":n%2?"#f7f7f7":"#fff",border:e===t.routedMessage&&e!==t.lastMessage?"1px solid #ccc":"none",cursor:e!==t.routedMessage&&e.user.isBot?"pointer":"default"},attrs:{id:"message-"+e.id},on:{click:function(n){t.routedMessage=e}}},[e.special?[r("em",[r("strong",[t._v(t._s(e.user.name)+" "+t._s(e.content))])])]:t._e(),t.tree.numSiblings(e)>1?[r("div",{staticStyle:{"font-size":"0.8em",color:"#aaa",float:"right"}},[r("nuxt-link",{staticClass:"mr-1",staticStyle:{color:"inherit"},attrs:{to:{query:{id:t.tree.sibling(e,-1).id}}},domProps:{textContent:t._s("< "+(t.tree.siblingIndex(e)+1))}}),t._v("/"),r("nuxt-link",{staticClass:"ml-1",staticStyle:{color:"inherit"},attrs:{to:{query:{id:t.tree.sibling(e,1).id}}},domProps:{textContent:t._s(t.tree.numSiblings(e)+" >")}})],1)]:t._e(),e.user.name!==t.user.name||t.editing.message?t._e():[r("a",{class:{"mr-1":t.tree.numSiblings(e)>1},staticStyle:{"font-size":"0.8em",color:"#aaa",float:"right",cursor:"pointer"},domProps:{textContent:t._s("üñâ")},on:{click:function(n){return t.edit(e)}}})],r("div",{class:{"text-primary":t.user&&e.user.name===t.user.name},style:{fontWeight:"bold"},domProps:{textContent:t._s(e.user.name)}}),t.editing.message!==e?r("div",{staticClass:"message-content",domProps:{innerHTML:t._s(t.$md.render(e.content))},on:{dblclick:function(n){return t.edit(e)}}}):r("div",[r("b-textarea",{attrs:{rows:"3","max-rows":"10"},on:{keydown:[function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")||n.ctrlKey||n.shiftKey||n.altKey||n.metaKey?null:(n.preventDefault(),function(){e.user.isBot||t.cloneAndSend()}.apply(null,arguments))},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.editing.message=null}]},model:{value:t.editing.input,callback:function(e){t.$set(t.editing,"input",e)},expression:"editing.input"}}),e.user.isBot?t._e():r("b-button",{staticClass:"m-1",attrs:{size:"sm",variant:"primary"},on:{click:t.cloneAndSend}},[t._v("Save & submit")]),r("b-button",{staticClass:"m-1",attrs:{size:"sm",variant:e.user.isBot?"primary":"outline-secondary"},on:{click:function(n){e.content=t.editing.input,t.editing.message=null}}},[t._v(t._s(e.user.isBot?"Save":"Just save"))]),r("b-button",{staticClass:"m-1",attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(e){t.editing.message=null}}},[t._v("Cancel")]),r("b-button",{staticClass:"m-1",attrs:{variant:"outline-danger",size:"sm"},on:{click:function(n){t.window.confirm("Are you sure you want to delete this message and all of its further replies? THERE IS NO UNDO!")&&(t.messages=t.tree.delete(e),t.routedMessage=t.tree.parent(e),t.editing.message=null)}}},[t._v("Delete")])],1),e===t.routedMessage?[t.generatingReply?r("div",{staticClass:"p-2 text-muted"},[r("em",[t._v("mindy is thinking"+t._s(".".repeat(t.typingCount+1)))])]):t._e()]:t._e(),e===t.routedMessage||e.bookmark||t.hoveredMessage===e?r("b-row",{staticClass:"pt-2",attrs:{"align-h":"between"}},[r("b-col",[e.user.isBot?r("b-button",{staticStyle:{"font-size":"0.8em"},attrs:{variant:"outline-secondary",disabled:t.sending||t.generatingReply,size:"sm"},on:{click:function(n){t.sendMessage(t.tree.parent(e).content,t.tree.parent(e),!0)}}},[t._v("‚Ü∫ Try again")]):t._e()],1),r("b-col",{staticClass:"text-right"},[e.user.isBot?r("b-button",{staticClass:"mx-1",style:e.upvoted?{}:{filter:"grayscale(100%)"},attrs:{variant:"light",size:"sm"},on:{click:function(n){return t.upvote(e)}}},[t._v("üëç")]):t._e(),r("b-button",{staticClass:"mx-1",style:e.bookmark?{cursor:"not-allowed"}:{filter:"grayscale(100%)"},attrs:{variant:"light",size:"sm"},on:{click:function(n){return t.bookmark(e)}}},[t._v("üîñ"),e.bookmark&&e.bookmark.name?r("span",{staticClass:"text-muted",domProps:{textContent:t._s(e.bookmark.name)}}):t._e()])],1),r("b-modal",{attrs:{id:"fine-tuning-request-modal",title:"Can we fine-tune Mindy based on your upvotes?","hide-footer":"",centered:""}},[r("p",[r("strong",[t._v("If you upvote a reply, we will send it to our servers and ‚Äútrain‚Äù Mindy to generate more replies like this one.¬†")]),t._v("This will also include the entire conversation thread, so that Mindy can understand the context.")]),r("p",[t._v("In the long run, we hope this will help Mindy generate better replies, and make you a happier user, too.")]),r("p",[t._v("So we will be grateful if you keep this switch on. :)")]),r("p",[t._v("(You can always turn this off in the settings.)")]),r("b-checkbox",{staticClass:"my-4",attrs:{switch:""},model:{value:t.settings.allowFineTuning,callback:function(e){t.$set(t.settings,"allowFineTuning",e)},expression:"settings.allowFineTuning"}},[t._v(t._s(t.settings.allowFineTuning?"Yes, ":"No, don‚Äôt ")+"send my upvotes to your servers to make Mindy better.")]),r("p",[t._v("Now let‚Äôs upvote that message!")]),r("b-button",{attrs:{variant:"primary",size:"lg"},on:{click:function(n){t.upvote(e),t.$bvModal.hide("fine-tuning-request-modal")}}},[t._v("üëç "+t._s(t.settings.allowFineTuning?"Upvote and send to servers":"Just upvote"))])],1)],1):t._e()],2)})),r("div",{ref:"scrollToBottom",attrs:{id:"scrollToBottom"}})],2),t.chatboxCollapsed?t._e():r("div",{staticClass:"footer p-2 border-bottom border-right border-left"},[t.user.name?t._e():[r("b-form-group",{attrs:{label:"Name","label-for":"username"}},[r("b-form-input",{attrs:{id:"username",value:t.enteredName,placeholder:"Enter your name to start chatting"},on:{input:function(e){t.enteredName=e.toLowerCase().replace(/[^a-z0-9-]+/g,"-").replace(/-+/g,"-")},change:function(e){t.user.name=t.enteredName}}})],1)],r("b-form",{staticClass:"mb-0",attrs:{id:"messageInputForm"},on:{submit:function(e){return e.preventDefault(),t.sendMessage()}}},[r("b-form-group",{attrs:{label:t.user&&t.user.name,"label-for":"input"}},[r("b-textarea",{ref:"input",staticStyle:{"font-size":"1em"},attrs:{id:"input",placeholder:"Enter to send, Shift+Enter for new line",disabled:!t.user||t.sending||t.generatingReply},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),void(t.user&&t.input&&!t.sending&&!t.generatingReply&&t.sendMessage()))}},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1),r("b-button",{attrs:{id:"sendButton",type:"submit",variant:t.sending?"outline-secondary":"primary",disabled:!t.input||t.sending||t.generatingReply,size:"sm"}},[t._v(t._s(t.sending?"Sending...":"Send")),t.sending?r("b-spinner",{attrs:{small:""}}):t._e()],1)],1)],2)]:r("b-spinner")],2),r("b-col",{staticClass:"px-4",class:t.chatboxCollapsed?"col-12":"col-lg-8 col-md-7 col-sm-12 col-12"},[t.routedMessage||t.messageForContext?[t.messageForContext?r("b-row",{staticClass:"justify-content-center text-center",style:t.narrow&&"height: calc(45vh - 50px)",attrs:{"align-v":"center"}},[t.messageForContext.context?r("MindyContext",{key:t.messageForContext.id,style:{filter:t.routedMessage&&t.routedMessage!==t.messageForContext||t.generating?"grayscale(25%) opacity(0.75)":"none"},attrs:{readonly:t.routedMessage!==t.messageForContext||t.generating},on:{rebuild:function(e){return t.generateContext(t.messageForContext)},"node-clicked":function(e){t.input=e,t.$nextTick(t.sendMessage)}},model:{value:t.messageForContext.context,callback:function(e){t.$set(t.messageForContext,"context",e)},expression:"messageForContext.context"}}):t._e()],1):t._e(),r("b-row",{staticClass:"justify-content-center mt-2"},[t.routedMessage&&!t.routedMessage.context&&t.routedMessage.user.isBot?r("b-button",{staticClass:"mx-1",attrs:{disabled:t.sending||t.generating,variant:t.generating?"light":"outline-primary"},on:{click:function(e){return t.generateContext(t.routedMessage)}}},[t._v("‰∏´ "+t._s(t.generatingContext?"Building mindmap...":t.generatingReply&&t.settings.autoBuildContext?"A little patience...":"Build mindmap"))]):t._e(),t.messageForContext&&t.messageForContext.id&&t.routedMessage!==t.messageForContext&&!t.generating?r("b-button",{staticClass:"mx-1",staticStyle:{"text-decoration":"none",color:"inherit","font-size":"1.2em"},attrs:{variant:"light",size:"sm",to:{query:{id:t.messageForContext.id}},title:"Go to message for this mindmap"}},[t._v(t._s(t.tree.lineage(t.messageForContext).includes(t.routedMessage)?"¬ª":"¬´"))]):t._e()],1)]:r("b-row",{staticClass:"text-muted",attrs:{"align-h":"center",justify:"center"}},[r("b-spinner",{staticClass:"text-muted",attrs:{type:"grow"}}),r("p",{staticClass:"mx-2 lead"},[t._v("Unwrapping the ü™Ñ...")])],1)],2)],1),r("OpenAIKeyModal",{ref:"openAIkeyModal",model:{value:t.openAIkey,callback:function(e){t.openAIkey=e},expression:"openAIkey"}}),r("div",{staticClass:"footer p-2 border-top border-right border-left fixed-bottom"},[r("div",{staticClass:"float-right text-right text-muted px-2"},[r("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"https://vzakharov.github.io/buy-me-a-beer/",target:"_blank",title:"Buy me a beer!"},on:{click:function(e){return t.mixpanel.track("Cheers! üç∫")}}},[t._v("üç∫")])]),r("div",{staticClass:"float-right text-right text-muted px-2",staticStyle:{cursor:"pointer",position:"fixed",top:"5px",right:"5px","z-index":"9999"},attrs:{title:"Dark mode"},on:{click:function(e){t.mixpanel.track("Dark mode on"),t.darkmode=!0}}},[t._v("‚òæ")]),r("div",{staticClass:"float-right text-right text-muted px-2",staticStyle:{cursor:"pointer"},attrs:{title:"Change OpenAI key"},on:{click:function(e){return t.$refs.openAIkeyModal.show()}}},[t._v(t._s(t.openAIkey?"üîë sk-..."+t.openAIkey.slice(-4):"üîë No OpenAI key"))]),r("div",{staticClass:"float-right text-right text-muted px-2",staticStyle:{cursor:"not-allowed"},attrs:{title:"Approximate USD spent on OpenAI API calls. Click to clear."},on:{click:function(){t.window.confirm("Are you sure you want to clear the cost counter?")&&(t.polygon.spent=0)}}},[t._v("üí∏ ~$"+t._s(parseFloat(t.polygon.spent).toFixed(2)))]),r("span",{staticClass:"float-left text-right px-2",class:t.settings.autoBuildContext?"text-success":"text-muted",staticStyle:{cursor:"pointer"},attrs:{title:"Auto-build mindmap is "+(t.settings.autoBuildContext?"on":"off")},on:{click:function(e){t.settings.autoBuildContext=!t.settings.autoBuildContext}}},[t._v("‰∏´")]),r("span",{staticClass:"float-left text-right text-muted px-2",staticStyle:{cursor:"pointer"},attrs:{title:"Mindy will generate "+t.settings.numGenerations+" "+(1===t.settings.numGenerations?"reply":"replies")+" at once"},on:{click:function(e){t.settings.numGenerations=t.settings.numGenerations%3+1}}},[t._v("üí¨ √ó "+t._s(t.settings.numGenerations))]),r("span",{staticClass:"float-left text-right text-muted px-2",staticStyle:{cursor:"pointer"},attrs:{title:"Mindy will generate replies with a temperature (i.e. ‚Äúcreativity‚Äù) of "+t.settings.temperature},on:{click:function(e){t.settings.temperature=Math.floor(10*(t.settings.temperature+.2))/10%1.2}}},[t._v(" "+t._s(0==t.settings.temperature?"ü•±":t.settings.temperature<=.2?"üòê":t.settings.temperature<=.4?"ü§î":t.settings.temperature<=.6?"üòâ":t.settings.temperature<=.8?"üòú":"ü§™")+"\nt="+t._s(Math.round(10*t.settings.temperature)/10))]),r("div",{staticClass:"float-left text-right text-muted px-2",staticStyle:{cursor:"pointer"},attrs:{title:"Edit settings"},on:{click:function(e){return t.$bvModal.show("settings-modal")}}},[t._v("...")]),r("b-modal",{attrs:{id:"settings-modal",title:"Settings","hide-footer":"","hide-header":"",centered:""}},[r("EditSettings",{attrs:{properties:{autoBuildContext:{label:"Auto-build mindmap",description:{true:"Mindy will automatically build a mindmap whenever you navigate to a reply.",false:'You will have to click the "Mindmap" button to build a mindmap.'}},numGenerations:{label:"Number of replies at once",description:"How many replies to generate at once. Increasing this helps explore more options, but also costs more."},temperature:{label:"Temperature",description:"How creative to be. 0 gives deterministic (same) replies, 1 gets... weird. Note that for 0 the number of replies is always 1."},allowFineTuning:{label:"Allow fine-tuning",description:{true:"Mindy will be sending your upvoted replies to our servers to fine-tune her. This helps her generate better replies, and makes you a happier user, too.",false:"Mindy will not be sending your upvoted replies to our servers."}}}},model:{value:t.settings,callback:function(e){t.settings=e},expression:"settings"}})],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{DarkMode:n(431).default,MindyContext:n(429).default,OpenAIKeyModal:n(432).default,EditSettings:n(405).default})}}]);