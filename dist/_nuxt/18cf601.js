(window.webpackJsonp=window.webpackJsonp||[]).push([[6,4],{395:function(e,t,n){var content=n(402);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(109).default)("ad7b5302",content,!0,{sourceMap:!1})},397:function(e,t,n){"use strict";t.a=function(){var e,t;return(t=console).log.apply(t,arguments),(e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e]}},398:function(e,t,n){"use strict";var r,o=n(34);n(84),n(15);t.a={methods:{try:(r=Object(o.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,l,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.length>2&&void 0!==d[2]?d[2]:{},o=r.errorMessage,c=r.catcher,this[t]=!0,e.prev=2,console.log("Started ".concat(t)),e.next=6,n();case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(2),l=e.t0,console.error("Error while ".concat(t,": ").concat(l)),"function"==typeof o&&(o=o(l)),this.alert(l,o),e.abrupt("return","function"==typeof c?c(l):void 0);case 16:return e.prev=16,this[t]=!1,console.log("Finished ".concat(t)),e.finish(16);case 20:case"end":return e.stop()}}),e,this,[[2,9,16,20]])}))),function(e,t){return r.apply(this,arguments)}),alert:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Something went wrong, please try again.";return this.$bvToast.toast("See console for error details.",{title:t,variant:"danger",solid:!0,autoHideDelay:5e3})}}}},401:function(e,t,n){"use strict";n(395)},402:function(e,t,n){var r=n(108)(!1);r.push([e.i,".code[data-v-4f831244]{font-family:monospace;background-color:#1e1e1e;color:#d4d4d4;height:calc(100% - 2.5rem)}",""]),e.exports=r},408:function(e,t,n){var content=n(437);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(109).default)("1b7833da",content,!0,{sourceMap:!1})},410:function(e,t,n){"use strict";n.r(t);n(171);var r,o,c=n(34),l=n(29),d=n(28),m=n(67),h=n(126),f=n(49),y=n(166),v=(n(84),n(396),n(11),n(22),n(1),n(30),n(397),{data:function(){var e;return e={state:!1},Object.assign(e,{promise:new Promise((function(t){return Object.assign(e,{resolve:t})}))}),{mounted:e}},mounted:function(){return this.mounted.resolve(),this.mounted.state=!0}});function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(h.a)(this,n)}}r=function(e){Object(m.a)(n,e);var t=k(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n)}(Object(y.a)(Error)),o=function(line){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(line.length-line.trimLeft().length)/e};var w,x={mixins:[v],props:["value"],data:function(){return{chartRendered:!1}},computed:{context:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isValid:function(){var e;try{return this.validate(this.context),!0}catch(t){return e=t,console.error(e),!1}},mermaidString:function(){var e;try{this.validate(this.context)}catch(e){return e,""}return e="mindmap\n"+this.context.replace(/[~@\-~"()]/g,(function(e){return"#".concat(e.charCodeAt(0),";")})),console.log(e),e}},mounted:function(){var script;return console.log("MindyContext mounted"),document.getElementById("mermaid-init")?console.log("mermaid-init script already exists"):(console.log("creating mermaid-init script"),(script=document.createElement("script")).id="mermaid-init",script.type="module",window.mermaidLoaded={state:!1,resolve:null},window.mermaidLoaded.promise=new Promise((function(e){return Object.assign(window.mermaidLoaded,{resolve:e})})),script.innerHTML="let resolve = null\nimport mermaid from 'https://unpkg.com/mermaid@9/dist/mermaid.esm.mjs';\nconsole.log({mermaid})\nimport mindmap from 'https://unpkg.com/@mermaid-js/mermaid-mindmap@9/dist/mermaid-mindmap.esm.mjs';\nconsole.log({mindmap})\nawait mermaid.registerExternalDiagrams([mindmap]);\nmermaid.startOnLoad = false;\nObject.assign(window, {mermaid, mindmap});\nconsole.log('mermaid loaded')\nwindow.mermaidLoaded.state = true\nwindow.mermaidLoaded.resolve()",document.head.appendChild(script),console.log(script))},watch:{mermaidString:{immediate:!0,handler:(w=Object(c.a)(regeneratorRuntime.mark((function e(t){var element;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.chartRendered=!1,console.log("Creating mermaid chart for",t),this.mounted.state){e.next=7;break}return console.log("Waiting for the component to be mounted"),e.next=6,this.mounted.promise;case 6:console.log("Component mounted");case 7:if(window.mermaidLoaded.state){e.next=12;break}return console.log("Waiting for mermaid to be loaded"),e.next=11,window.mermaidLoaded.promise;case 11:console.log("Mermaid loaded");case 12:return element=document.getElementById("mermaid-container"),e.abrupt("return",this.$nextTick((function(){return console.log("Updating mermaid chart"),null!=element&&element.removeAttribute("data-processed"),mermaid.init()})));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})}},methods:{helloWorld:function(){return console.log("Hello world")},validate:function(e){var i,t,n,c,l;if(n=e.split("\n"),0!==o(n[0]))throw new r("The first line must not be indented");if(0===o(n[1]))throw new r("The second line must be indented");for(l=o(n[1],1),i=t=2,c=n.length;2<=c?t<c:t>c;i=2<=c?++t:--t){if(o(n[i],l)>o(n[i-1],l)+1)throw new r("Line ".concat(i+1," is indented by more than one level more than the previous line"));if(o(n[i],l)<1)throw new r("Line ".concat(i+1," is not indented; only one root topic is allowed"))}return!0}}},O=x,I=(n(401),n(68)),component=Object(I.a)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-tabs",{attrs:{"nav-wrapper-class":"sticky-top bg-white"}},[n("b-tab",{attrs:{title:"Mind map"}},[n("b-container",[n("b-row",{staticClass:"sticky-top",staticStyle:{height:"calc(100vh - 200px)"},attrs:{"align-v":"center"}},[n("b-col",[e.isValid?n("pre",{staticClass:"mermaid",attrs:{id:"mermaid-container"},domProps:{textContent:e._s(e.mermaidString)}}):n("b-alert",{attrs:{variant:"danger",show:""}},[n("strong",[e._v("Cannot render the mind map; please edit the context in the "),n("em",[e._v("Plain text")]),e._v(" tab.")]),n("ul",[n("li",[e._v("Exactly one line with no indentation in the beginning")]),n("li",[e._v("The second line must be indented by one level")]),n("li",[e._v("Every next line must be indented by not more than previous line plus one and not less than one level")])])])],1)],1)],1)],1),n("b-tab",{attrs:{title:"Plain text"}},[n("b-textarea",{style:{borderColor:e.isValid?"transparent":"red",fontFamily:"monospace"},attrs:{rows:"25"},model:{value:e.context,callback:function(t){e.context=t},expression:"context"}})],1)],1)],1)}),[],!1,null,"4f831244",null);t.default=component.exports},411:function(e,t,n){"use strict";n.r(t);var r=n(34),o=(n(84),n(105)),c=n.n(o),l={mixins:[n(398).a],props:["value"],data:function(){return console.log("OpenAIKeyModal value: ".concat(this.value)),{openAIkey:this.value,checkingKey:!1,keyValid:!!this.value}},methods:{show:function(){return this.$refs.openAIKeyModal.show()},hide:function(){return this.$refs.openAIKeyModal.hide()},checkKey:function(){var e=this;return this.try("checkingKey",Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Checking key ".concat(e.openAIkey)),t.next=3,c.a.post("https://api.openai.com/v1/engines/text-ada-001/completions",{prompt:"Hello",max_tokens:1},{headers:{Authorization:"Bearer ".concat(e.openAIkey)}});case 3:return e.$bvToast.toast("Yay, the key is valid! Enjoy the app!",{title:"Success",variant:"success",autoHideDelay:3e3}),e.keyValid=!0,e.$emit("input",e.openAIkey),t.abrupt("return",e.hide());case 7:case"end":return t.stop()}}),t)}))),{errorMessage:function(e){var t;return 401===(null!=e&&null!=(t=e.response)?t.status:void 0)&&"Invalid API key"}})}}},d=n(68),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"openAIKeyModal",attrs:{title:"Enter your OpenAI API key","hide-footer":"","no-close-on-backdrop":!e.openAIkey||!e.keyValid,"no-close-on-esc":!e.openAIkey||!e.keyValid,"hide-header-close":!e.openAIkey||!e.keyValid}},[n("h4",[e._v("Why?")]),n("p",[e._v("This app uses the OpenAI API to generate texts.\nWe DO NOT store your API key anywhere on our servers.\nYou can get your own API keyÂ "),n("a",{attrs:{href:"https://beta.openai.com/account/api-keys",target:"_blank"}},[e._v("here")]),e._v(".")]),n("b-form",{on:{submit:function(t){return t.preventDefault(),e.checkKey()}}},[n("b-form-group",{attrs:{label:"OpenAI API key","label-for":"openAIkey"}},[n("b-form-input",{attrs:{id:"openAIkey",type:"text",placeholder:"sk-...",disabled:e.checkingKey},model:{value:e.openAIkey,callback:function(t){e.openAIkey=t},expression:"openAIkey"}})],1),n("b-button",{attrs:{type:"submit",variant:"primary",disabled:!e.openAIkey||e.checkingKey}},[n("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.checkingKey,expression:"checkingKey"}],attrs:{small:"",type:"grow"}}),e._v(e._s(e.checkingKey?"Checking...":"Check and save"))],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports},435:function(e,t,n){"use strict";(function(e){n(5),n(4),n(2),n(1),n(6),n(3),n(7);var r=n(0),o=n(105),c=n.n(o);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a=function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.polygonAPIurl,o=void 0===r?"https://ideality.app/api/polygon/":r,l=n.databaseId,m=void 0===l?"485b3bd6b4524c1dbd9ef2acc5bccfbf":l,h=n.openAIkey,f=void 0===h?e.env.OPENAI_KEY:h,y=n.defaultParameters,v=void 0===y?{}:y;return t=c.a.create({baseURL:o}),{run:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return console.log("Running",e,{variables:n,parameters:r}),t.post("/run",{databaseId:m,slug:e,openAIkey:f,variables:n,parameters:d(d({},v),r)}).then((function(e){return e.data}))}}}}).call(this,n(134))},436:function(e,t,n){"use strict";n(408)},437:function(e,t,n){var r=n(108)(!1);r.push([e.i,"label{font-weight:700}.footer{border-top:1px solid #e7e7e7}.footer,.header{background-color:#f7f7f7}.header{border-bottom:1px solid #e7e7e7}",""]),e.exports=r},440:function(e,t,n){"use strict";n.r(t);var r=n(35),o=n(34),c=n(33),l=(n(84),n(133),n(1),n(85),n(110),n(15),n(18),n(16),n(3),n(396),n(11),n(22),n(37),n(30),n(248),n(41),n(105),n(403)),d=n.n(l),m=(n(412),n(4),n(2),n(6),n(7),n(0)),h=n(40),f=(n(52),n(5),n(434));function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(m.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}n(173);var k,w=n(397);k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[["createdAt","desc"]];return Object.assign(this,{items:e,root:{id:0},parent:function(t){return e.find((function(i){return i.id===t.parentId}))||this.root},children:function(n){return d()(e).filter((function(e){return n?e.parentId===n.id:!e.parentId})).orderBy(t).value()},siblings:function(n){var r=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return d.a.orderBy(e.filter((function(e){return r.parent(e)===r.parent(n)&&(o||e!==n)}),t))},numSiblings:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.siblings(e,t).length},siblingIndex:function(e){return this.siblings(e).indexOf(e)},sibling:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(t=((t=this.siblingIndex(e))+n)%this.numSiblings(e);t<0;)t+=this.numSiblings(e);return this.siblings(e)[t]},nextSibling:function(e){return this.sibling(e,1)},prevSibling:function(e){return this.sibling(e,-1)},ancestors:function(e){return e.parentId?[this.parent(e)].concat(Object(c.a)(this.ancestors(this.parent(e)))):[]},lineage:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=Object(c.a)(this.ancestors(e)).reverse(),n&&t.push(e),t[0]===this.root&&t.shift(),console.log({item:e,includeSelf:n,lineage:t}),t},heir:function(e){return this.children(e).length?this.heir(d.a.orderBy.apply(d.a,[this.children(e)].concat(Object(c.a)(t)))[0]):e},thread:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.lineage(t?this.heir(e):e)},createChild:function(t,n){return Object(w.a)({item:t},Object.assign(n,{parentId:null!=t?t.id:void 0,id:d()(e).map("id").max()+1||1,createdAt:new Date}))},clone:function(e){return this.createChild(this.parent(e),d.a.omit(e,"id","createdAt"))},delete:function(t){var n,r=this;return n=this.children(t),e.splice(e.indexOf(t),1),n.forEach((function(e){return r.delete(e)})),e}})};var x,O=k,I={mounted:function(){var e;if(window.vm){for(e=1;window["vm".concat(e)];)e++;return window["vm".concat(e)]=this}return window.vm=this}},j=n(398),C={data:function(){return{window:null}},mounted:function(){return Object.assign(this,{window:window})}},_=n(435),A={mixins:[function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.computeSettings,o=n.keys,c=n.container,l=n.format,d=void 0===l?"json":l;return"yaml"===d?(t=f.a.load,e=f.a.dump):(t=JSON.parse,e=JSON.stringify),{mounted:function(){var n,l=this;if(void 0===c&&(c=this.settings||this),c!==this&&!(n=Object.keys(this).find(key((function(){return l[key]===c})))))throw new Error("Could not find container key in this");return(o||Object.keys(c)).forEach((function(o){var d,m,f,y,k;if(k=localStorage.getItem(o),d=c[o],console.log({key:o,localValue:k,defaultValue:d}),f="object"===Object(h.a)(d)&&null!==d,m=Array.isArray(d),f&&(k=t(k||null)),c[o]=f&&!m?v(v({},d),k):k||d,y=n?"".concat(n,".").concat(o):o,l.$watch(y,{deep:!0,handler:function(t){return localStorage.setItem(o,f?e(t):t)}}),r)return Object.defineProperty(l,o,{get:function(){return c[o]},set:function(e){return c[o]=e}})}))}}}({keys:["user","messages","openAIkey"],format:"yaml"}),I,j.a,C],data:function(){return{input:"",lastMessageTime:null,sending:!1,generatingContext:!1,generatingReply:!1,enteredName:"",checkingName:!1,editing:{message:null,input:""},nameUnavailable:!1,user:{name:null},messages:[],openAIkey:null,typingCount:0,typingInterval:null,bot:{name:"mindy",isBot:!0},idsBySlug:null,previousThread:null}},computed:{tree:function(){return new O(this.messages)},routedMessage:function(){var e,t,n;return(null!=(t=null!=(e=this.$route.query.id)?(e=parseInt(e),d.a.find(this.messages,{id:e})):d.a.last(this.messages))&&null!=(n=t.user)?n.isBot:void 0)||!this.tree.children(t).length?t:d.a.first(this.tree.children(t))},thread:function(){var e;return(null!=(e=this.previousThread)?e.includes(this.routedMessage):void 0)?this.previousThread:this.previousThread=this.tree.thread(this.routedMessage||this.tree.root)},lastMessage:function(){return d.a.last(this.thread)},polygon:function(){return new _.a({openAIkey:this.openAIkey,defaultParameters:{max_tokens:300}})}},mounted:function(){if(!this.openAIkey)return console.log("OpenAI key not set; showing modal"),this.$refs.openAIkeyModal.show()},methods:{addMessage:function(e){return this.messages=[].concat(Object(c.a)(this.messages),[e]),e},edit:function(e){return this.editing.message=e,this.editing.input=e.content},sendMessage:(x=Object(o.a)(regeneratorRuntime.mark((function e(){var input,t,n,c,l,m,h=this,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return input=f.length>0&&void 0!==f[0]?f[0]:this.input,t=f.length>1&&void 0!==f[1]?f[1]:d.a.last(this.thread)||this.tree.root,n=f.length>2&&void 0!==f[2]&&f[2],console.log({input:input,parent:t,retrying:n}),e.next=6,this.idsBySlug;case 6:return e.sent,(n?this.tree.parent(t):t)!==this.tree.root&&(c=!0,l=this.tree.lineage(t,!n).map((function(e){var t=e.user.isBot,content=e.content;return"".concat(t?"Mindy":"User",":\n").concat(content)})).join("\n\n"),console.log({previousConversation:l})),m=c?"continued":"first",e.abrupt("return",this.try("sending",(function(){var e;return n?e=t:(e=h.addMessage(h.tree.createChild(t,{user:h.user,content:input})),h.input="",h.$router.push({query:{id:e.id}}),h.$nextTick((function(){return h.$refs.scrollToBottom.scrollIntoView()}))),console.log({message:e}),h.$nextTick((function(){return h.try("generatingReply",Object(o.a)(regeneratorRuntime.mark((function t(){var n,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.polygon.run(m,{input:input,previousConversation:l});case 2:return f=t.sent,n=f.choices,h.input="",console.log({message:e,choices:n}),n.forEach((function(t){var n,d,text=t.text;return d=h.addMessage(h.tree.createChild(e,{user:h.bot,content:text})),console.log({reply:d}),c&&(n=h.tree.parent(e).context,console.log({previousContext:n})),h.try("generatingContext",Object(o.a)(regeneratorRuntime.mark((function e(){var t,o,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.polygon.run("context-".concat(m),{input:input,previousConversation:l,previousContext:n,reply:text});case 2:return c=e.sent,f=Object(r.a)(c.choices,1),text=f[0].text,t=function(line){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(line.length-line.trimLeft().length)/e},o=function(e){var n,r;return n=(e=(e="function"==typeof e.replace?e.replace(/```[\s\S]*?/,""):void 0).trim()).trim().split("\n"),r=t(n[1],1),(n=n.map((function(line){var e;return e=t(line,r),line.replace(/^\s*/,"  ".repeat(e))}))).join("\n")},e.abrupt("return",h.$set(d,"context",o(text)));case 8:case"end":return e.stop()}}),e)}))))})),t.abrupt("return",h.$nextTick((function(){return h.$router.push({query:{id:d.a.last(h.messages).id}}),h.$refs.scrollToBottom.scrollIntoView(),h.$nextTick((function(){var e;return null!=(e=document.querySelector("#input"))?e.focus():void 0}))})));case 8:case"end":return t.stop()}}),t)}))),{catcher:function(t){return console.error(t),h.messages=d.a.without(h.messages,e),input=e.content}})}))})));case 10:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)}),cloneAndSend:function(){try{return this.sendMessage(this.editing.input,this.tree.parent(this.editing.message))}finally{this.editing.message=null}}},watch:{generatingReply:function(e){var t=this;return clearInterval(this.typingInterval),e?(this.$nextTick((function(){return t.$refs.scrollToBottom.scrollIntoView()})),this.typingInterval=setInterval((function(){return t.typingCount=(t.typingCount+1)%3}),500)):this.typingCount=0},"$route.query.id":{immediate:!0,handler:function(e){return console.log({id:e})}}}},S=A,M=(n(436),n(68)),component=Object(M.a)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{staticClass:"p-5 vh-100",attrs:{fluid:""}},[n("b-row",[n("b-col",{staticClass:"p-0",staticStyle:{height:"calc(100vh - 200px)"}},[e.messages?[n("div",{staticClass:"header text-center border-top border-right border-left"},[n("h1",{staticClass:"display-3",staticStyle:{"font-size":"2.5rem"}},[e._v("Mindy")]),n("p",{staticClass:"lede"},[e._v("Someone you can talk to")])]),n("div",{staticClass:"border-right border-left",staticStyle:{height:"calc(100vh - 350px)","overflow-y":"scroll"},attrs:{id:"messages"}},[e._l(e.thread,(function(t,r){return n("div",{key:r,staticClass:"mt-2 p-2",style:{"background-color":r%2?"#f7f7f7":"#fff",border:t===e.routedMessage&&t!==e.lastMessage?"1px solid #ccc":"none",cursor:t!==e.routedMessage&&t.user.isBot?"pointer":"default"},on:{click:function(n){t!==e.routedMessage&&t.user.isBot&&e.$router.push({query:{id:t.id}})}}},[t.special?[n("em",[n("strong",[e._v(e._s(t.user.name)+" "+e._s(t.content))])])]:e._e(),e.tree.numSiblings(t)>1?[n("div",{staticStyle:{"font-size":"0.8em",color:"#aaa",float:"right"}},[n("nuxt-link",{staticClass:"mr-1",staticStyle:{color:"inherit"},attrs:{to:{query:{id:e.tree.sibling(t,-1).id}}},domProps:{textContent:e._s("< "+(e.tree.siblingIndex(t)+1))}}),e._v("/"),n("nuxt-link",{staticClass:"ml-1",staticStyle:{color:"inherit"},attrs:{to:{query:{id:e.tree.sibling(t,1).id}}},domProps:{textContent:e._s(e.tree.numSiblings(t)+" >")}})],1)]:e._e(),t.user.name!==e.user.name||e.editing.message?e._e():[n("a",{class:{"mr-1":e.tree.numSiblings(t)>1},staticStyle:{"font-size":"0.8em",color:"#aaa",float:"right",cursor:"pointer"},domProps:{textContent:e._s("ð")},on:{click:function(n){return e.edit(t)}}})],n("div",{class:{"text-primary":e.user&&t.user.name===e.user.name},style:{fontWeight:"bold"},domProps:{textContent:e._s(t.user.name)}}),e.editing.message!==t?n("div",{domProps:{innerHTML:e._s(e.$md.render(t.content))},on:{dblclick:function(n){return e.edit(t)}}}):n("div",[n("b-textarea",{attrs:{rows:"3","max-rows":"10"},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.cloneAndSend.apply(null,arguments))},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.editing.message=null}]},model:{value:e.editing.input,callback:function(t){e.$set(e.editing,"input",t)},expression:"editing.input"}}),n("b-button",{staticClass:"m-1",attrs:{variant:"primary",size:"sm"},on:{click:e.cloneAndSend}},[e._v("Save & submit")]),n("b-button",{staticClass:"m-1",attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(n){t.content=e.editing.input,e.editing.message=null}}},[e._v("Just save")]),n("b-button",{staticClass:"m-1",attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(t){e.editing.message=null}}},[e._v("Cancel")]),n("b-button",{staticClass:"m-1",attrs:{variant:"outline-danger",size:"sm"},on:{click:function(n){e.window.confirm("Are you sure you want to delete this message and all of its further replies? THERE IS NO UNDO!")&&(e.messages=e.tree.delete(t),e.$router.push({query:{id:e.tree.parent(t).id}}),e.editing.message=null)}}},[e._v("Delete")])],1),t===e.routedMessage?[e.generatingReply?n("div",{staticClass:"p-2 text-muted"},[n("em",[e._v("mindy is thinking"+e._s(".".repeat(e.typingCount+1)))])]):e._e(),t.user.isBot?n("div",{staticClass:"p-2 text-center"},[n("b-button",{attrs:{variant:"outline-secondary",disabled:e.sending||e.generatingReply},on:{click:function(n){e.sendMessage(e.tree.parent(t).content,e.tree.parent(t),!0)}}},[e._v("âº Try again")])],1):e._e()]:e._e()],2)})),n("div",{ref:"scrollToBottom",staticClass:"mt-2"})],2),n("div",{staticClass:"footer p-2 border-bottom border-right border-left"},[e.user.name?e._e():[n("b-form-group",{attrs:{label:"Name","label-for":"username"}},[n("b-form-input",{attrs:{id:"username",value:e.enteredName,placeholder:"Enter your name to start chatting"},on:{input:function(t){e.enteredName=t.toLowerCase().replace(/[^a-z0-9-]+/g,"-").replace(/-+/g,"-")},change:function(t){e.user.name=e.enteredName}}})],1)],n("b-form",{staticClass:"mb-0",on:{submit:function(t){return t.preventDefault(),e.sendMessage()}}},[n("b-form-group",{attrs:{label:e.user&&e.user.name,"label-for":"input"}},[n("b-textarea",{attrs:{id:"input",placeholder:"Enter to send, Shift+Enter for new line",disabled:!e.user||e.sending||e.generatingReply},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),void(e.user&&e.input&&!e.sending&&!e.generatingReply&&e.sendMessage()))}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1),n("b-button",{attrs:{type:"submit",variant:e.sending?"outline-secondary":"primary",disabled:!e.input||e.sending||e.generatingReply}},[e._v(e._s(e.sending?"Sending...":"Send")),e.sending?n("b-spinner",{attrs:{small:""}}):e._e()],1)],1)],2)]:n("b-spinner")],2),n("b-col",{staticClass:"col-xl-8 col-lg-7 col-md-6 col-sm-12 col-12"},[n("div",{style:{position:"sticky",top:"0"}},[e.routedMessage&&e.routedMessage.context?n("MindyContext",{model:{value:e.routedMessage.context,callback:function(t){e.$set(e.routedMessage,"context",t)},expression:"routedMessage.context"}}):e.generatingReply||e.generatingContext?n("b-spinner"):n("p",{staticClass:"text-muted"},[e._v("Start a conversation to see the context")])],1)])],1),n("OpenAIKeyModal",{ref:"openAIkeyModal",model:{value:e.openAIkey,callback:function(t){e.openAIkey=t},expression:"openAIkey"}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{MindyContext:n(410).default,OpenAIKeyModal:n(411).default})}}]);